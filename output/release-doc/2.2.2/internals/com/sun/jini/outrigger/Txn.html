<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Sun Nov 10 23:24:25 EST 2013 -->
<title>Txn (Apache River v2.2.2 API Documentation (internals))</title>
<meta name="date" content="2013-11-10">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Txn (Apache River v2.2.2 API Documentation (internals))";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Txn.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/sun/jini/outrigger/TransitionWatchers.html" title="class in com.sun.jini.outrigger"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../com/sun/jini/outrigger/TxnMonitor.html" title="class in com.sun.jini.outrigger"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/sun/jini/outrigger/Txn.html" target="_top">Frames</a></li>
<li><a href="Txn.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.sun.jini.outrigger</div>
<h2 title="Class Txn" class="title">Class Txn</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.sun.jini.outrigger.Txn</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../com/sun/jini/outrigger/StorableObject.html" title="interface in com.sun.jini.outrigger">StorableObject</a>, <a href="../../../../com/sun/jini/outrigger/TransactableConstants.html" title="interface in com.sun.jini.outrigger">TransactableConstants</a>, <a href="../../../../com/sun/jini/outrigger/TransactableMgr.html" title="interface in com.sun.jini.outrigger">TransactableMgr</a>, <a href="../../../../net/jini/core/transaction/server/TransactionConstants.html" title="interface in net.jini.core.transaction.server">TransactionConstants</a></dd>
</dl>
<hr>
<br>
<pre> class <span class="strong">Txn</span>
extends <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="../../../../com/sun/jini/outrigger/TransactableMgr.html" title="interface in com.sun.jini.outrigger">TransactableMgr</a>, <a href="../../../../net/jini/core/transaction/server/TransactionConstants.html" title="interface in net.jini.core.transaction.server">TransactionConstants</a>, <a href="../../../../com/sun/jini/outrigger/StorableObject.html" title="interface in com.sun.jini.outrigger">StorableObject</a></pre>
<div class="block">This class represents a space's state in a single transaction.

 Object of this class represent Jini transactions within outrigger.
 These transactions hold "Transactables" -- things that represent
 the actions that have been taken under this transaction. For example, 
 if this transaction were to be cancelled, the Transactables are
 examined and serve as the list of things to roll back in order to 
 restore the state of the Space status quo ante.

 This is achieved by having the transactables notified of state changes 
 to this transaction such as preparing, commit, etc. The 
 transactables themselves are responsible for "doing the right thing."

 NB: some--but not all--of the actions one can take with a transaction
 are managed internally by these objects. That is, all of the important
 methods objects of these types are synchronized. Therefore, two
 simultaneous calls to abort() and commit() are arbitrated properly. 

 However, care must be taken when add()ing a transactable. Even
 though the add() method is synchronized if you check the state of
 the transaction to ensure that is active and then call add() the
 transaction could have left the active state between the check and
 the add() call unless the call obtains the appropriate locks. This 
 is even more likely if other work needs to be done in addition to
 calling add() (e.g. persisting state, obtaining locks, etc.). The
 caller of add() should lock the associated transaction object and
 ensure that the transaction is still considered ACTIVE, do whatever
 work is necessary to complete while the transaction is in the ACTIVE
 state (including calling call add()) and then release the lock.
 This can be done by :
 <ul>
 <li> holding the lock on this object while checking the
      state and carrying out the operation (including calling add()), or
 <li> calling ensureActive() to check the state
      and obtain a non-exclusive lock, carrying out the operation
      (including calling add()), and then calling allowStateChange() to
      release the lock.
 </ul>
 The pair of ensureActive() and allowStateChange() allows for more
 concurrency if the operation is expected to take a long time, in
 that it will allow for other operations to be performed under the
 same transaction and let aborts prevent other operations from
 being started.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>Sun Microsystems, Inc.</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#id">id</a></strong></code>
<div class="block">The internal id Outrigger as assigned to the transaction</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/logging/Logger.html?is-external=true" title="class or interface in java.util.logging">Logger</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#logger">logger</a></strong></code>
<div class="block">Logger for logging transaction related information</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../com/sun/jini/outrigger/TxnMonitorTask.html" title="class in com.sun.jini.outrigger">TxnMonitorTask</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#monitorTask">monitorTask</a></strong></code>
<div class="block">The task responsible for monitoring to see if this
 transaction has been aborted with us being told, or
 null if no such task as been allocated.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#state">state</a></strong></code>
<div class="block">What state we think the transaction is in</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#stateChangeWaiting">stateChangeWaiting</a></strong></code>
<div class="block"><code>true</code> if there is a blocked state change.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#stateReaders">stateReaders</a></strong></code>
<div class="block">Count of number of threads holding a read lock on state</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../net/jini/core/transaction/server/ServerTransaction.html" title="class in net.jini.core.transaction.server">ServerTransaction</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#tr">tr</a></strong></code>
<div class="block">Cached <code>ServerTransaction</code> object for
 the transaction this object is fronting for.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#trId">trId</a></strong></code>
<div class="block">The id the transaction manager assigned to this transaction</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../com/sun/jini/outrigger/StorableReference.html" title="class in com.sun.jini.outrigger">StorableReference</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#trm">trm</a></strong></code>
<div class="block">The transaction manager associated with the transaction 
 this object is fronting for.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#txnables">txnables</a></strong></code>
<div class="block">The list of <code>Transactable</code> participating in 
 this transaction.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_com.sun.jini.outrigger.TransactableConstants">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;com.sun.jini.outrigger.<a href="../../../../com/sun/jini/outrigger/TransactableConstants.html" title="interface in com.sun.jini.outrigger">TransactableConstants</a></h3>
<code><a href="../../../../com/sun/jini/outrigger/TransactableConstants.html#READ">READ</a>, <a href="../../../../com/sun/jini/outrigger/TransactableConstants.html#stateNames">stateNames</a>, <a href="../../../../com/sun/jini/outrigger/TransactableConstants.html#TAKE">TAKE</a>, <a href="../../../../com/sun/jini/outrigger/TransactableConstants.html#WRITE">WRITE</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_net.jini.core.transaction.server.TransactionConstants">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;net.jini.core.transaction.server.<a href="../../../../net/jini/core/transaction/server/TransactionConstants.html" title="interface in net.jini.core.transaction.server">TransactionConstants</a></h3>
<code><a href="../../../../net/jini/core/transaction/server/TransactionConstants.html#ABORTED">ABORTED</a>, <a href="../../../../net/jini/core/transaction/server/TransactionConstants.html#ACTIVE">ACTIVE</a>, <a href="../../../../net/jini/core/transaction/server/TransactionConstants.html#COMMITTED">COMMITTED</a>, <a href="../../../../net/jini/core/transaction/server/TransactionConstants.html#NOTCHANGED">NOTCHANGED</a>, <a href="../../../../net/jini/core/transaction/server/TransactionConstants.html#PREPARED">PREPARED</a>, <a href="../../../../net/jini/core/transaction/server/TransactionConstants.html#VOTING">VOTING</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#Txn(long)">Txn</a></strong>(long&nbsp;id)</code>
<div class="block">Used in recovery</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#Txn(net.jini.core.transaction.server.ServerTransaction, long)">Txn</a></strong>(<a href="../../../../net/jini/core/transaction/server/ServerTransaction.html" title="class in net.jini.core.transaction.server">ServerTransaction</a>&nbsp;tr,
   long&nbsp;id)</code>
<div class="block">Create a new <code>Txn</code> that represents our state in the
 given <code>ServerTransaction</code>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#abort(com.sun.jini.outrigger.OutriggerServerImpl)">abort</a></strong>(<a href="../../../../com/sun/jini/outrigger/OutriggerServerImpl.html" title="class in com.sun.jini.outrigger">OutriggerServerImpl</a>&nbsp;space)</code>
<div class="block">Abort the transaction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../com/sun/jini/outrigger/Transactable.html" title="interface in com.sun.jini.outrigger">Transactable</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#add(com.sun.jini.outrigger.Transactable)">add</a></strong>(<a href="../../../../com/sun/jini/outrigger/Transactable.html" title="interface in com.sun.jini.outrigger">Transactable</a>&nbsp;t)</code>
<div class="block">Caution: see locking discussion at the class level.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#allowStateChange()">allowStateChange</a></strong>()</code>
<div class="block">Release the read lock created by an <code>ensureActive</code>
 call.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#cleanup()">cleanup</a></strong>()</code>
<div class="block">Clean up any state when the transaction is finished.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#commit(com.sun.jini.outrigger.OutriggerServerImpl)">commit</a></strong>(<a href="../../../../com/sun/jini/outrigger/OutriggerServerImpl.html" title="class in com.sun.jini.outrigger">OutriggerServerImpl</a>&nbsp;space)</code>
<div class="block">Having prepared, roll the changes
 forward.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#ensureActive()">ensureActive</a></strong>()</code>
<div class="block">Atomically checks that this transaction is in the active
 state and locks the transaction in the active state.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#getId()">getId</a></strong>()</code>
<div class="block">Get the id for this txn.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="../../../../net/jini/core/transaction/server/TransactionManager.html" title="interface in net.jini.core.transaction.server">TransactionManager</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#getManager()">getManager</a></strong>()</code>
<div class="block">Return the manager associated with this transaction.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) int</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#getState()">getState</a></strong>()</code>
<div class="block">Return our local view of the current state.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../net/jini/core/transaction/server/ServerTransaction.html" title="class in net.jini.core.transaction.server">ServerTransaction</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#getTransaction(net.jini.security.ProxyPreparer)">getTransaction</a></strong>(<a href="../../../../net/jini/security/ProxyPreparer.html" title="interface in net.jini.security">ProxyPreparer</a>&nbsp;preparer)</code>
<div class="block">Return the <code>ServerTransaction</code> which this manager
 handles.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) long</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#getTransactionId()">getTransactionId</a></strong>()</code>
<div class="block">We keep the transaction ID around because we may need it
 to identify a broken transaction after recovery.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#makeInactive()">makeInactive</a></strong>()</code>
<div class="block">Prevents new operations from being started under this
 transaction and blocks until in process operations are
 completed.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="../../../../com/sun/jini/outrigger/TxnMonitorTask.html" title="class in com.sun.jini.outrigger">TxnMonitorTask</a></code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#monitorTask()">monitorTask</a></strong>()</code>
<div class="block">Return the monitor task for this object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#monitorTask(com.sun.jini.outrigger.TxnMonitorTask)">monitorTask</a></strong>(<a href="../../../../com/sun/jini/outrigger/TxnMonitorTask.html" title="class in com.sun.jini.outrigger">TxnMonitorTask</a>&nbsp;task)</code>
<div class="block">Set the monitor task for this object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) int</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#prepare(com.sun.jini.outrigger.OutriggerServerImpl)">prepare</a></strong>(<a href="../../../../com/sun/jini/outrigger/OutriggerServerImpl.html" title="class in com.sun.jini.outrigger">OutriggerServerImpl</a>&nbsp;space)</code>
<div class="block">Prepare for transaction commit.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#restore(java.io.ObjectInputStream)">restore</a></strong>(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/ObjectInputStream.html?is-external=true" title="class or interface in java.io">ObjectInputStream</a>&nbsp;in)</code>
<div class="block">Restore the persistent fields</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/sun/jini/outrigger/Txn.html#store(java.io.ObjectOutputStream)">store</a></strong>(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/ObjectOutputStream.html?is-external=true" title="class or interface in java.io">ObjectOutputStream</a>&nbsp;out)</code>
<div class="block">Store the persistent fields</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="id">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>id</h4>
<pre>private final&nbsp;long id</pre>
<div class="block">The internal id Outrigger as assigned to the transaction</div>
</li>
</ul>
<a name="state">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>state</h4>
<pre>private&nbsp;int state</pre>
<div class="block">What state we think the transaction is in</div>
</li>
</ul>
<a name="trm">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>trm</h4>
<pre>private&nbsp;<a href="../../../../com/sun/jini/outrigger/StorableReference.html" title="class in com.sun.jini.outrigger">StorableReference</a> trm</pre>
<div class="block">The transaction manager associated with the transaction 
 this object is fronting for.</div>
</li>
</ul>
<a name="tr">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tr</h4>
<pre>private&nbsp;<a href="../../../../net/jini/core/transaction/server/ServerTransaction.html" title="class in net.jini.core.transaction.server">ServerTransaction</a> tr</pre>
<div class="block">Cached <code>ServerTransaction</code> object for
 the transaction this object is fronting for.</div>
</li>
</ul>
<a name="trId">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>trId</h4>
<pre>private&nbsp;long trId</pre>
<div class="block">The id the transaction manager assigned to this transaction</div>
</li>
</ul>
<a name="txnables">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>txnables</h4>
<pre>private final&nbsp;<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a> txnables</pre>
<div class="block">The list of <code>Transactable</code> participating in 
 this transaction.</div>
</li>
</ul>
<a name="monitorTask">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>monitorTask</h4>
<pre>private&nbsp;<a href="../../../../com/sun/jini/outrigger/TxnMonitorTask.html" title="class in com.sun.jini.outrigger">TxnMonitorTask</a> monitorTask</pre>
<div class="block">The task responsible for monitoring to see if this
 transaction has been aborted with us being told, or
 null if no such task as been allocated.</div>
</li>
</ul>
<a name="stateReaders">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stateReaders</h4>
<pre>private&nbsp;int stateReaders</pre>
<div class="block">Count of number of threads holding a read lock on state</div>
</li>
</ul>
<a name="stateChangeWaiting">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stateChangeWaiting</h4>
<pre>private&nbsp;boolean stateChangeWaiting</pre>
<div class="block"><code>true</code> if there is a blocked state change. Used
 to give writers priority.</div>
</li>
</ul>
<a name="logger">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>logger</h4>
<pre>private static final&nbsp;<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/logging/Logger.html?is-external=true" title="class or interface in java.util.logging">Logger</a> logger</pre>
<div class="block">Logger for logging transaction related information</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Txn(net.jini.core.transaction.server.ServerTransaction, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>Txn</h4>
<pre>Txn(<a href="../../../../net/jini/core/transaction/server/ServerTransaction.html" title="class in net.jini.core.transaction.server">ServerTransaction</a>&nbsp;tr,
   long&nbsp;id)</pre>
<div class="block">Create a new <code>Txn</code> that represents our state in the
 given <code>ServerTransaction</code>.</div>
</li>
</ul>
<a name="Txn(long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Txn</h4>
<pre>Txn(long&nbsp;id)</pre>
<div class="block">Used in recovery</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getId()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getId</h4>
<pre><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;getId()</pre>
<div class="block">Get the id for this txn. Note that this id is NOT the same as
 the ID of the transaction. Since that ID is not unique (it must
 be qualified with the <code>ServerTransaction</code> object) we create
 our own internal id to make txns unique. This is needed since we
 may not have the <code>Transaction</code> unmarshalled.</div>
</li>
</ul>
<a name="getTransactionId()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTransactionId</h4>
<pre>long&nbsp;getTransactionId()</pre>
<div class="block">We keep the transaction ID around because we may need it
 to identify a broken transaction after recovery.</div>
</li>
</ul>
<a name="getState()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getState</h4>
<pre>int&nbsp;getState()</pre>
<div class="block">Return our local view of the current state. Need to be holding
 the lock on this object or have called <code>ensureActive</code>
 to get the current value.</div>
</li>
</ul>
<a name="ensureActive()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ensureActive</h4>
<pre>void&nbsp;ensureActive()
            throws <a href="../../../../net/jini/core/transaction/CannotJoinException.html" title="class in net.jini.core.transaction">CannotJoinException</a></pre>
<div class="block">Atomically checks that this transaction is in the active
 state and locks the transaction in the active state.
 The lock can be released by calling <code>allowStateChange</code>.
 Each call to this method should be paired with a call to
 <code>allowStateChange</code> in a finally block.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../net/jini/core/transaction/CannotJoinException.html" title="class in net.jini.core.transaction">CannotJoinException</a></code> - if the transaction
 is not active or a state change is pending.</dd></dl>
</li>
</ul>
<a name="allowStateChange()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>allowStateChange</h4>
<pre>void&nbsp;allowStateChange()</pre>
<div class="block">Release the read lock created by an <code>ensureActive</code>
 call. Does nothing if the transaction is not active or there is
 a state change pending and thus is safe to call even if the
 corresponding <code>ensureActive</code> call threw
 <code>CannotJoinException</code>.</div>
</li>
</ul>
<a name="makeInactive()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>makeInactive</h4>
<pre>void&nbsp;makeInactive()</pre>
<div class="block">Prevents new operations from being started under this
 transaction and blocks until in process operations are
 completed.</div>
</li>
</ul>
<a name="prepare(com.sun.jini.outrigger.OutriggerServerImpl)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepare</h4>
<pre>int&nbsp;prepare(<a href="../../../../com/sun/jini/outrigger/OutriggerServerImpl.html" title="class in com.sun.jini.outrigger">OutriggerServerImpl</a>&nbsp;space)</pre>
<div class="block">Prepare for transaction commit. <code>makeInactive</code> must have 
 been called on this transaction first.</div>
</li>
</ul>
<a name="abort(com.sun.jini.outrigger.OutriggerServerImpl)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>abort</h4>
<pre>void&nbsp;abort(<a href="../../../../com/sun/jini/outrigger/OutriggerServerImpl.html" title="class in com.sun.jini.outrigger">OutriggerServerImpl</a>&nbsp;space)</pre>
<div class="block">Abort the transaction.  This must be callable from
 <code>prepare</code> because if a <code>Transactable</code>
 votes <code>ABORT</code>, this method is called to make that
 happen. <code>makeInactive</code> must have been called on this
 transaction first.</div>
</li>
</ul>
<a name="commit(com.sun.jini.outrigger.OutriggerServerImpl)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre>void&nbsp;commit(<a href="../../../../com/sun/jini/outrigger/OutriggerServerImpl.html" title="class in com.sun.jini.outrigger">OutriggerServerImpl</a>&nbsp;space)</pre>
<div class="block">Having prepared, roll the changes
 forward. <code>makeInactive</code> must have been called on
 this transaction first.</div>
</li>
</ul>
<a name="add(com.sun.jini.outrigger.Transactable)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>add</h4>
<pre>public&nbsp;<a href="../../../../com/sun/jini/outrigger/Transactable.html" title="interface in com.sun.jini.outrigger">Transactable</a>&nbsp;add(<a href="../../../../com/sun/jini/outrigger/Transactable.html" title="interface in com.sun.jini.outrigger">Transactable</a>&nbsp;t)</pre>
<div class="block">Caution: see locking discussion at the class level.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/sun/jini/outrigger/TransactableMgr.html#add(com.sun.jini.outrigger.Transactable)">add</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/sun/jini/outrigger/TransactableMgr.html" title="interface in com.sun.jini.outrigger">TransactableMgr</a></code></dd>
</dl>
</li>
</ul>
<a name="getTransaction(net.jini.security.ProxyPreparer)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTransaction</h4>
<pre>public&nbsp;<a href="../../../../net/jini/core/transaction/server/ServerTransaction.html" title="class in net.jini.core.transaction.server">ServerTransaction</a>&nbsp;getTransaction(<a href="../../../../net/jini/security/ProxyPreparer.html" title="interface in net.jini.security">ProxyPreparer</a>&nbsp;preparer)
                                 throws <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                                        <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ClassNotFoundException.html?is-external=true" title="class or interface in java.lang">ClassNotFoundException</a></pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../../com/sun/jini/outrigger/TransactableMgr.html#getTransaction(net.jini.security.ProxyPreparer)">TransactableMgr</a></code></strong></div>
<div class="block">Return the <code>ServerTransaction</code> which this manager
 handles. If necessary deserialize the manager and optionally
 prepare it. Will only deserialize the manager if it has not
 already been deserialized. Will only prepare the manager if
 <code>preparer</code> is non-null and no previous call to
 <code>getTransaction</code> has succeeded. If this method
 throws an exception, preparation has not succeeded. If a
 previous call to this method has succeed, all future calls will
 succeed and return the same object as the first successful
 call.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/sun/jini/outrigger/TransactableMgr.html#getTransaction(net.jini.security.ProxyPreparer)">getTransaction</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/sun/jini/outrigger/TransactableMgr.html" title="interface in com.sun.jini.outrigger">TransactableMgr</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>preparer</code> - the <code>ProxyPreparer</code> to
                 be used to prepare the reference. May
                 be <code>null</code>.</dd>
<dt><span class="strong">Returns:</span></dt><dd>the <code>ServerTransaction</code> which this manager
         handles.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if the unmarshalling fails. Will
                 also throw <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/rmi/RemoteException.html?is-external=true" title="class or interface in java.rmi"><code>RemoteException</code></a>
                 if <code>preparer.prepareProxy</code>
                 does.</dd>
<dd><code><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ClassNotFoundException.html?is-external=true" title="class or interface in java.lang">ClassNotFoundException</a></code> - if unmarshalling fails
                 with one.</dd></dl>
</li>
</ul>
<a name="getManager()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getManager</h4>
<pre><a href="../../../../net/jini/core/transaction/server/TransactionManager.html" title="interface in net.jini.core.transaction.server">TransactionManager</a>&nbsp;getManager()</pre>
<div class="block">Return the manager associated with this transaction.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the manager associated with this transaction.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this <code>Txn</code>
         is still broken.</dd></dl>
</li>
</ul>
<a name="monitorTask()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>monitorTask</h4>
<pre><a href="../../../../com/sun/jini/outrigger/TxnMonitorTask.html" title="class in com.sun.jini.outrigger">TxnMonitorTask</a>&nbsp;monitorTask()</pre>
<div class="block">Return the monitor task for this object. Note, this
 method is unsynchronized because it (and 
 <code>monitorTask(TxnMonitorTask)</code> are both called
 from the same thread.</div>
</li>
</ul>
<a name="monitorTask(com.sun.jini.outrigger.TxnMonitorTask)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>monitorTask</h4>
<pre>void&nbsp;monitorTask(<a href="../../../../com/sun/jini/outrigger/TxnMonitorTask.html" title="class in com.sun.jini.outrigger">TxnMonitorTask</a>&nbsp;task)</pre>
<div class="block">Set the monitor task for this object. Note, this method is
 unsynchronized because it (and <code>monitorTask()</code> are
 both called from the same thread.</div>
</li>
</ul>
<a name="cleanup()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cleanup</h4>
<pre>private&nbsp;void&nbsp;cleanup()</pre>
<div class="block">Clean up any state when the transaction is finished.</div>
</li>
</ul>
<a name="store(java.io.ObjectOutputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>store</h4>
<pre>public&nbsp;void&nbsp;store(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/ObjectOutputStream.html?is-external=true" title="class or interface in java.io">ObjectOutputStream</a>&nbsp;out)
           throws <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../../com/sun/jini/outrigger/StorableObject.html#store(java.io.ObjectOutputStream)">StorableObject</a></code></strong></div>
<div class="block">Store the persistent fields</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/sun/jini/outrigger/StorableObject.html#store(java.io.ObjectOutputStream)">store</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/sun/jini/outrigger/StorableObject.html" title="interface in com.sun.jini.outrigger">StorableObject</a></code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="restore(java.io.ObjectInputStream)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>restore</h4>
<pre>public&nbsp;void&nbsp;restore(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/ObjectInputStream.html?is-external=true" title="class or interface in java.io">ObjectInputStream</a>&nbsp;in)
             throws <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                    <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ClassNotFoundException.html?is-external=true" title="class or interface in java.lang">ClassNotFoundException</a></pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../../com/sun/jini/outrigger/StorableObject.html#restore(java.io.ObjectInputStream)">StorableObject</a></code></strong></div>
<div class="block">Restore the persistent fields</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../com/sun/jini/outrigger/StorableObject.html#restore(java.io.ObjectInputStream)">restore</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../com/sun/jini/outrigger/StorableObject.html" title="interface in com.sun.jini.outrigger">StorableObject</a></code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ClassNotFoundException.html?is-external=true" title="class or interface in java.lang">ClassNotFoundException</a></code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Txn.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/sun/jini/outrigger/TransitionWatchers.html" title="class in com.sun.jini.outrigger"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../com/sun/jini/outrigger/TxnMonitor.html" title="class in com.sun.jini.outrigger"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/sun/jini/outrigger/Txn.html" target="_top">Frames</a></li>
<li><a href="Txn.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright 2007-2013, multiple authors.<br>Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0" target="child" >Apache License, Version 2.0</a>, see the <a href="../../../../doc-files/NOTICE" target="child" >NOTICE</a> file for attributions.</small></p>
</body>
</html>
