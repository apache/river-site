<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Sun Nov 10 23:24:25 EST 2013 -->
<title>BackEnd (Apache River v2.2.2 API Documentation (internals))</title>
<meta name="date" content="2013-11-10">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="BackEnd (Apache River v2.2.2 API Documentation (internals))";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BackEnd.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.ConsumerThread.html" title="class in com.sun.jini.outrigger.snaplogstore"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/sun/jini/outrigger/snaplogstore/BackEnd.html" target="_top">Frames</a></li>
<li><a href="BackEnd.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.sun.jini.outrigger.snaplogstore</div>
<h2 title="Class BackEnd" class="title">Class BackEnd</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.sun.jini.outrigger.snaplogstore.BackEnd</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Observer.html?is-external=true" title="class or interface in java.util">Observer</a></dd>
</dl>
<hr>
<br>
<pre> class <span class="strong">BackEnd</span>
extends <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Observer.html?is-external=true" title="class or interface in java.util">Observer</a></pre>
<div class="block">Back end of snapshot log store. This class consumes logs written by
 LogOutputFile and stores the state as serilalzied objects. The class
 processes the logs to optimize what is stored in the snapshot. For
 example, a take log record will cause the removal of a write log
 record with the same id (if the transaction is null).  <p>

 Likewise, cancels will cause the removal of write and register
 records.  Also renew records update the expiration of the entry or
 registration and are not stored directly in the database.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.ConsumerThread.html" title="class in com.sun.jini.outrigger.snaplogstore">BackEnd.ConsumerThread</a></strong></code>
<div class="block">Thread to consume log files.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.LastLog.html" title="class in com.sun.jini.outrigger.snaplogstore">BackEnd.LastLog</a></strong></code>
<div class="block">This class remembers which log file was the last to be
 successfully consumed.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.ConsumerThread.html" title="class in com.sun.jini.outrigger.snaplogstore">BackEnd.ConsumerThread</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#consumer">consumer</a></strong></code>
<div class="block">Log file consumer thread.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#entries">entries</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../com/sun/jini/outrigger/StoredObject.html" title="interface in com.sun.jini.outrigger">StoredObject</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#joinState">joinState</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.LastLog.html" title="class in com.sun.jini.outrigger.snaplogstore">BackEnd.LastLog</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#lastLog">lastLog</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#logFileBase">logFileBase</a></strong></code>
<div class="block">The base name for the log files.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/logging/Logger.html?is-external=true" title="class or interface in java.util.logging">Logger</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#logger">logger</a></strong></code>
<div class="block">Logger for logging persistent store related information</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#pendingTxns">pendingTxns</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#registrations">registrations</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#retry">retry</a></strong></code>
<div class="block">Number of times to attempt to restart the consumer thread.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#sessionId">sessionId</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#SNAPSHOT_VERSION">SNAPSHOT_VERSION</a></strong></code>
<div class="block">Keep logs and snapshot tied, though not necessary</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../com/sun/jini/outrigger/snaplogstore/SnapshotFile.html" title="class in com.sun.jini.outrigger.snaplogstore">SnapshotFile</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#snapshotFile">snapshotFile</a></strong></code>
<div class="block">Snapshot object</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#snapshotFileBase">snapshotFileBase</a></strong></code>
<div class="block">The base name for the snapshot files</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#topUuid">topUuid</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#WAIT_FOR_THREAD">WAIT_FOR_THREAD</a></strong></code>
<div class="block">Max time to wait for the consumer thread to die on destroy</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#BackEnd(java.lang.String)">BackEnd</a></strong>(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;path)</code>
<div class="block">Create a new <code>BackEnd</code> with the given <code>path</code>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#abortOp(java.lang.Long)">abortOp</a></strong>(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</code>
<div class="block">This method aborts a pending transaction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#bootOp(long, long)">bootOp</a></strong>(long&nbsp;time,
      long&nbsp;session)</code>
<div class="block">This method sets the session id in the database.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#cancelOp(byte[])">cancelOp</a></strong>(byte[]&nbsp;cookie)</code>
<div class="block">This method processes a logged cancel operation.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#close()">close</a></strong>()</code>
<div class="block">Stop the consumer and close the database.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#commitOp(java.lang.Long)">commitOp</a></strong>(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</code>
<div class="block">This method commits a pending transaction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#consumeLogs(boolean)">consumeLogs</a></strong>(boolean&nbsp;all)</code>
<div class="block">Consume the log files that exist.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#destroy()">destroy</a></strong>()</code>
<div class="block">Destroy the consumer thread and database</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#joinStateOp(com.sun.jini.outrigger.StoredObject)">joinStateOp</a></strong>(<a href="../../../../../com/sun/jini/outrigger/StoredObject.html" title="interface in com.sun.jini.outrigger">StoredObject</a>&nbsp;state)</code>
<div class="block">Record the join state.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../net/jini/space/InternalSpaceException.html" title="class in net.jini.space">InternalSpaceException</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#logAndThrowRecoveryException(java.lang.String, java.lang.Throwable)">logAndThrowRecoveryException</a></strong>(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;msg,
                            <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&nbsp;nested)</code>
<div class="block">Log and throw an InternalSpaceException to flag a store
 recovery problem.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../com/sun/jini/outrigger/snaplogstore/PendingTxn.html" title="class in com.sun.jini.outrigger.snaplogstore">PendingTxn</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#pendingTxn(java.lang.Long)">pendingTxn</a></strong>(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</code>
<div class="block">Return the pending transaction description for the given
 transaction, creating the object and adding it to the table if
 necessary.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#prepareOp(java.lang.Long, com.sun.jini.outrigger.StoredObject)">prepareOp</a></strong>(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId,
         <a href="../../../../../com/sun/jini/outrigger/StoredObject.html" title="interface in com.sun.jini.outrigger">StoredObject</a>&nbsp;transaction)</code>
<div class="block">This method prepares a pending transaction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#recoverSnapshot()">recoverSnapshot</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#registerOp(com.sun.jini.outrigger.snaplogstore.Registration)">registerOp</a></strong>(<a href="../../../../../com/sun/jini/outrigger/snaplogstore/Registration.html" title="class in com.sun.jini.outrigger.snaplogstore">Registration</a>&nbsp;registration)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#removePendingTxn(java.lang.Long)">removePendingTxn</a></strong>(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</code>
<div class="block">Remove a pending transaction from the table.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#renewOp(byte[], long)">renewOp</a></strong>(byte[]&nbsp;cookie,
       long&nbsp;expiration)</code>
<div class="block">This method processes a logged renew operation.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#setupStore(com.sun.jini.outrigger.Recover)">setupStore</a></strong>(<a href="../../../../../com/sun/jini/outrigger/Recover.html" title="interface in com.sun.jini.outrigger">Recover</a>&nbsp;space)</code>
<div class="block">Setup the database store and recover any existing state.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#startConsumer()">startConsumer</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#takeOp(byte[], java.lang.Long)">takeOp</a></strong>(byte[]&nbsp;cookie,
      <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</code>
<div class="block">This method records a logged take operation.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#update(java.util.Observable, java.lang.Object)">update</a></strong>(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Observable.html?is-external=true" title="class or interface in java.util">Observable</a>&nbsp;source,
      <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;arg)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#uuidOp(byte[])">uuidOp</a></strong>(byte[]&nbsp;uuid)</code>
<div class="block">This method records the service's top level <code>Uuid</code></div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.html#writeOp(com.sun.jini.outrigger.snaplogstore.Resource, java.lang.Long)">writeOp</a></strong>(<a href="../../../../../com/sun/jini/outrigger/snaplogstore/Resource.html" title="class in com.sun.jini.outrigger.snaplogstore">Resource</a>&nbsp;entry,
       <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</code>
<div class="block">This method records a logged write operation.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="sessionId">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sessionId</h4>
<pre>private&nbsp;<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a> sessionId</pre>
</li>
</ul>
<a name="joinState">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>joinState</h4>
<pre>private&nbsp;<a href="../../../../../com/sun/jini/outrigger/StoredObject.html" title="interface in com.sun.jini.outrigger">StoredObject</a> joinState</pre>
</li>
</ul>
<a name="entries">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>entries</h4>
<pre>private&nbsp;<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a> entries</pre>
</li>
</ul>
<a name="registrations">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>registrations</h4>
<pre>private&nbsp;<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a> registrations</pre>
</li>
</ul>
<a name="pendingTxns">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pendingTxns</h4>
<pre>private&nbsp;<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a> pendingTxns</pre>
</li>
</ul>
<a name="topUuid">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>topUuid</h4>
<pre>private&nbsp;byte[] topUuid</pre>
</li>
</ul>
<a name="lastLog">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lastLog</h4>
<pre>private&nbsp;<a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.LastLog.html" title="class in com.sun.jini.outrigger.snaplogstore">BackEnd.LastLog</a> lastLog</pre>
</li>
</ul>
<a name="retry">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>retry</h4>
<pre>private&nbsp;int retry</pre>
<div class="block">Number of times to attempt to restart the consumer thread.</div>
</li>
</ul>
<a name="snapshotFile">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>snapshotFile</h4>
<pre>private&nbsp;<a href="../../../../../com/sun/jini/outrigger/snaplogstore/SnapshotFile.html" title="class in com.sun.jini.outrigger.snaplogstore">SnapshotFile</a> snapshotFile</pre>
<div class="block">Snapshot object</div>
</li>
</ul>
<a name="SNAPSHOT_VERSION">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SNAPSHOT_VERSION</h4>
<pre>private final&nbsp;int SNAPSHOT_VERSION</pre>
<div class="block">Keep logs and snapshot tied, though not necessary</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../constant-values.html#com.sun.jini.outrigger.snaplogstore.BackEnd.SNAPSHOT_VERSION">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="logFileBase">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logFileBase</h4>
<pre>private&nbsp;<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> logFileBase</pre>
<div class="block">The base name for the log files.</div>
</li>
</ul>
<a name="snapshotFileBase">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>snapshotFileBase</h4>
<pre>private&nbsp;<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> snapshotFileBase</pre>
<div class="block">The base name for the snapshot files</div>
</li>
</ul>
<a name="consumer">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>consumer</h4>
<pre>private&nbsp;<a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.ConsumerThread.html" title="class in com.sun.jini.outrigger.snaplogstore">BackEnd.ConsumerThread</a> consumer</pre>
<div class="block">Log file consumer thread.</div>
</li>
</ul>
<a name="WAIT_FOR_THREAD">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>WAIT_FOR_THREAD</h4>
<pre>private static final&nbsp;long WAIT_FOR_THREAD</pre>
<div class="block">Max time to wait for the consumer thread to die on destroy</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../constant-values.html#com.sun.jini.outrigger.snaplogstore.BackEnd.WAIT_FOR_THREAD">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="logger">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>logger</h4>
<pre>private static final&nbsp;<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/logging/Logger.html?is-external=true" title="class or interface in java.util.logging">Logger</a> logger</pre>
<div class="block">Logger for logging persistent store related information</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BackEnd(java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BackEnd</h4>
<pre>BackEnd(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;path)</pre>
<div class="block">Create a new <code>BackEnd</code> with the given <code>path</code>.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setupStore(com.sun.jini.outrigger.Recover)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setupStore</h4>
<pre>void&nbsp;setupStore(<a href="../../../../../com/sun/jini/outrigger/Recover.html" title="interface in com.sun.jini.outrigger">Recover</a>&nbsp;space)</pre>
<div class="block">Setup the database store and recover any existing state.</div>
</li>
</ul>
<a name="recoverSnapshot()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recoverSnapshot</h4>
<pre>private&nbsp;void&nbsp;recoverSnapshot()</pre>
</li>
</ul>
<a name="startConsumer()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startConsumer</h4>
<pre>private&nbsp;void&nbsp;startConsumer()</pre>
</li>
</ul>
<a name="update(java.util.Observable, java.lang.Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>update</h4>
<pre>public&nbsp;void&nbsp;update(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Observable.html?is-external=true" title="class or interface in java.util">Observable</a>&nbsp;source,
          <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;arg)</pre>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Observer.html?is-external=true#update(java.util.Observable, java.lang.Object)" title="class or interface in java.util">update</a></code>&nbsp;in interface&nbsp;<code><a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Observer.html?is-external=true" title="class or interface in java.util">Observer</a></code></dd>
</dl>
</li>
</ul>
<a name="destroy()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>destroy</h4>
<pre>void&nbsp;destroy()</pre>
<div class="block">Destroy the consumer thread and database</div>
</li>
</ul>
<a name="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>void&nbsp;close()</pre>
<div class="block">Stop the consumer and close the database.</div>
</li>
</ul>
<a name="pendingTxn(java.lang.Long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pendingTxn</h4>
<pre>private&nbsp;<a href="../../../../../com/sun/jini/outrigger/snaplogstore/PendingTxn.html" title="class in com.sun.jini.outrigger.snaplogstore">PendingTxn</a>&nbsp;pendingTxn(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</pre>
<div class="block">Return the pending transaction description for the given
 transaction, creating the object and adding it to the table if
 necessary.</div>
</li>
</ul>
<a name="removePendingTxn(java.lang.Long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removePendingTxn</h4>
<pre>private&nbsp;void&nbsp;removePendingTxn(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</pre>
<div class="block">Remove a pending transaction from the table.  If it isn't there,
 this call is harmless.</div>
</li>
</ul>
<a name="bootOp(long, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bootOp</h4>
<pre>void&nbsp;bootOp(long&nbsp;time,
          long&nbsp;session)</pre>
<div class="block">This method sets the session id in the database. It's value is
 only used during recovery after a restart.</div>
</li>
</ul>
<a name="joinStateOp(com.sun.jini.outrigger.StoredObject)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>joinStateOp</h4>
<pre>void&nbsp;joinStateOp(<a href="../../../../../com/sun/jini/outrigger/StoredObject.html" title="interface in com.sun.jini.outrigger">StoredObject</a>&nbsp;state)</pre>
<div class="block">Record the join state.</div>
</li>
</ul>
<a name="writeOp(com.sun.jini.outrigger.snaplogstore.Resource, java.lang.Long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeOp</h4>
<pre>void&nbsp;writeOp(<a href="../../../../../com/sun/jini/outrigger/snaplogstore/Resource.html" title="class in com.sun.jini.outrigger.snaplogstore">Resource</a>&nbsp;entry,
           <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</pre>
<div class="block">This method records a logged write operation. If under a
 transaction the resource is held in a list for the pending
 transaction. When committed this method will be called again
 with the resource and a null transaction id.</div>
</li>
</ul>
<a name="takeOp(byte[], java.lang.Long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>takeOp</h4>
<pre>void&nbsp;takeOp(byte[]&nbsp;cookie,
          <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</pre>
<div class="block">This method records a logged take operation. If under a
 transaction the resource is held in a list for the pending
 transaction. When committed this method will be called again
 with the resource and a null transaction id.</div>
</li>
</ul>
<a name="registerOp(com.sun.jini.outrigger.snaplogstore.Registration)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>registerOp</h4>
<pre>void&nbsp;registerOp(<a href="../../../../../com/sun/jini/outrigger/snaplogstore/Registration.html" title="class in com.sun.jini.outrigger.snaplogstore">Registration</a>&nbsp;registration)</pre>
</li>
</ul>
<a name="renewOp(byte[], long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>renewOp</h4>
<pre>void&nbsp;renewOp(byte[]&nbsp;cookie,
           long&nbsp;expiration)</pre>
<div class="block">This method processes a logged renew operation. Renew operations
 apply to resources passed into writeOp and registerOp.</div>
</li>
</ul>
<a name="cancelOp(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cancelOp</h4>
<pre>void&nbsp;cancelOp(byte[]&nbsp;cookie)</pre>
<div class="block">This method processes a logged cancel operation. Cancel operations
 apply to resources passed into writeOp and registerOp.</div>
</li>
</ul>
<a name="prepareOp(java.lang.Long, com.sun.jini.outrigger.StoredObject)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareOp</h4>
<pre>void&nbsp;prepareOp(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId,
             <a href="../../../../../com/sun/jini/outrigger/StoredObject.html" title="interface in com.sun.jini.outrigger">StoredObject</a>&nbsp;transaction)</pre>
<div class="block">This method prepares a pending transaction.</div>
</li>
</ul>
<a name="commitOp(java.lang.Long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commitOp</h4>
<pre>void&nbsp;commitOp(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</pre>
<div class="block">This method commits a pending transaction.</div>
</li>
</ul>
<a name="abortOp(java.lang.Long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>abortOp</h4>
<pre>void&nbsp;abortOp(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;txnId)</pre>
<div class="block">This method aborts a pending transaction.</div>
</li>
</ul>
<a name="uuidOp(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>uuidOp</h4>
<pre>void&nbsp;uuidOp(byte[]&nbsp;uuid)</pre>
<div class="block">This method records the service's top level <code>Uuid</code></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uuid</code> - The service's <code>Uuid</code> represented as a
             <code>byte[16]</code>.</dd></dl>
</li>
</ul>
<a name="consumeLogs(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>consumeLogs</h4>
<pre>private&nbsp;void&nbsp;consumeLogs(boolean&nbsp;all)</pre>
<div class="block">Consume the log files that exist.  If <code>all</code> is
 <code>true</code>, all found log files will be processed.
 If <code>log</code> is <code>false</code>, then all but the
 most recent will be processed; this will prevent the back
 end from reading the log file that is currently being
 produced by the front end.</div>
</li>
</ul>
<a name="logAndThrowRecoveryException(java.lang.String, java.lang.Throwable)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>logAndThrowRecoveryException</h4>
<pre>private&nbsp;<a href="../../../../../net/jini/space/InternalSpaceException.html" title="class in net.jini.space">InternalSpaceException</a>&nbsp;logAndThrowRecoveryException(<a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;msg,
                                                  <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&nbsp;nested)</pre>
<div class="block">Log and throw an InternalSpaceException to flag a store
 recovery problem.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BackEnd.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../com/sun/jini/outrigger/snaplogstore/BackEnd.ConsumerThread.html" title="class in com.sun.jini.outrigger.snaplogstore"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/sun/jini/outrigger/snaplogstore/BackEnd.html" target="_top">Frames</a></li>
<li><a href="BackEnd.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright 2007-2013, multiple authors.<br>Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0" target="child" >Apache License, Version 2.0</a>, see the <a href="../../../../../doc-files/NOTICE" target="child" >NOTICE</a> file for attributions.</small></p>
</body>
</html>
